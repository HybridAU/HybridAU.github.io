<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://xo.tc/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="shortcut icon" type="image/png" href="https://xo.tc/favicon.png" />
  <link rel="stylesheet" type="text/css" href="https://xo.tc/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://xo.tc/theme/css/pygments.css">
  <!--
  This is almost certainly the wrong way to do this but it's the only way
  I can find to load the fonts in a subdirectory
  -->
    <link rel="stylesheet" type="text/css" href="https://xo.tc/theme/css/load-fonts.css">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Michael Van Delft">
  <meta name="description" content="Posts and writings by Michael Van Delft">

  <link href="https://xo.tc/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Exotic Security Atom" />

<meta name="keywords" content="Man in the middle, Encryption, IPv6, Standards">

  <title>Thinking about how to defend against the PoisonTap &ndash; Exotic Security</title>

</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="https://xo.tc">
        <img src="/images/gavitar_140.png" alt="logo">
      </a>
      <h2><a href="https://xo.tc">Michael Van Delft</a></h2>
      <p>Exotic Security</p>
      <ul>
        <li><a href="https://xo.tc/pages/about.html">About</a></li>
        <li><a href="/tags.html">Tags</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://xo.tc">Index</a> &brvbar; <a href="https://xo.tc/archives.html">Archives</a>
      &brvbar; <a href="https://xo.tc/feeds/all.atom.xml">Atom</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h3><a href="https://xo.tc/thinking-about-how-to-defend-against-the-poisontap.html">Thinking about how to defend against the PoisonTap</a></h3>
  </div>
  <div class="article_text">
    <p>Recently the Samy Kamkar has come out with a device called a <a href="https://samy.pl/poisontap/">PoisonTap</a>, a few months before that Mubix was <a href="https://room362.com/post/2016/snagging-creds-from-locked-machines/">talking about</a> getting credentials from a locked computer with the <a href="https://lanturtle.com/">LAN Turtle</a>.</p>
<p>Both these attacks exploit the same underlying issue which is that most operating systems (Windows, Linux<sup id="fnref:linux"><a class="footnote-ref" href="#fn:linux">1</a></sup> and OSX) will automatically trust a USB network when it's attached and start sending data over it.</p>
<p>I've been thinking a lot about how we as the IT Security Community can defend against these sorts of attacks.</p>
<p>The most obvious idea that springs to mind is to issue the user with some sort of popup "New network detected, do you want to connect?" but there are a few issues with that.</p>
<p>The first is that it's a horrible user experience (UX) because 99.9% of the time the answer will be "Yes" ... "Why do you think I plugged in my usb 4g dongle if I didn't want to use it!?".</p>
<p>The second is that sometimes you need the network to start working before you can login. A few years ago I worked at a high school we used RADIUS to secure our WiFi. Students could connect with their domain credentials. We had shared laptops in the school library but the laptops couldn't authenticate with the RADIUS server until students had logged in, but students couldn't login to the laptops without network. This will likely only get worse, with devices like <a href="https://www.google.com/chromebook/about/">Chromebooks</a> and Windows 10 pushing Microsoft accounts pretty hard.</p>
<p>The defences that PoisonTap jokingly <a href="https://samy.pl/poisontap/#toc_11">suggest for desktop security</a> are funny but impractical such as</p>
<blockquote>
<p>Adding cement to your USB and Thunderbolt ports can be effective</p>
</blockquote>
<p>In the end I don't really think there is any good client side defence for these sorts of attacks. Instead I think it needs to be at the protocol level, we need to bake security in by default. Things saying browsers vendors saying we will only support HTTP/2 <a href="https://en.wikipedia.org/wiki/HTTP/2#Encryption">if it's encrypted</a>.</p>
<p>We should demand encryption in any new protocol and systems susceptible to passive monitoring should be treated as a vulnerable and rejected. It might be a long an painful journey but I can imagine an internet where all communications are secure by default.</p>
<p>I always though it was disappointing that IPv6 didn't make encryption mandatory it would have been great to have security built right in at the <a href="https://en.wikipedia.org/wiki/Internet_layer">Internet  layer</a>.  </p>
<div class="footnote">
<hr>
<ol>
<li id="fn:linux">
<p>There are hundreds of distributions but, when I say "Linux" I mean mainstream distributions like Debian / Ubuntu / Red Hat / Fedora with their default settings.&#160;<a class="footnote-backref" href="#fnref:linux" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div>
  <div class="article_meta">
      <p>Posted on: <abbr title="2017-01-05 07:00:00+08:00" >Thu 05 January 2017</abbr></p>
    <p>Category: <a href="https://xo.tc/category/posts.html">Posts</a>
 &ndash; Tags:
      <a href="https://xo.tc/tag/man-in-the-middle.html">Man in the middle</a>,      <a href="https://xo.tc/tag/encryption.html">Encryption</a>,      <a href="https://xo.tc/tag/ipv6.html">IPv6</a>,      <a href="https://xo.tc/tag/standards.html">Standards</a>    </p>
  </div>


</article>


    <div id="ending_message">
      <p>
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
            <img alt="Creative Commons License" src="https://xo.tc/theme/images/cc-by-88x31.png" />
        </a>
        <br />Content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
        <br />Built using <a href="http://getpelican.com">Pelican</a>.
              Based on a theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack">github</a>.
      </p>
    </div>
  </main>
</body>
</html>